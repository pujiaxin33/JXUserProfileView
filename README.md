# JXUserProfileView
iOSï¼šä¸€åˆ†é’Ÿé›†æˆä¸»æµAPPä¸ªäººèµ„æ–™é¡µï¼ˆå¦‚ç®€ä¹¦ã€å¾®åšç­‰ï¼‰

## ä»“åº“è¿ç§»

**æœ¬ä»“åº“å·²ç»åœæ­¢æ›´æ–°ï¼Œæ‰€æœ‰ä»£ç å·²ç»è¿ç§»è‡³[JXPagingView](https://github.com/pujiaxin33/JXPagingView)**

## Github
[ä»“åº“åœ°å€](https://github.com/pujiaxin33/JXUserProfileView) å¦‚æœä½ å–œæ¬¢ï¼Œè®°å¾—ç‚¹é¢—â¤ï¸å“Ÿ
## å‰è¨€
  ä¼´éšç€APPä¸æ–­è¿­ä»£æ›´æ–°ï¼Œå„ç§åŠŸèƒ½ä¹Ÿæ˜¯è¶Šå †è¶Šå¤šã€‚å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œåœ¨ä¸ªäººèµ„æ–™é¡µé¢éœ€è¦æ˜¾ç¤ºçš„å…ƒç´ ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚å¦‚ä½•äº•ç„¶æœ‰åºçš„å±•ç¤ºä¸”äº¤äº’ç®€å•ï¼Œå˜æˆäº†ä¸€ä¸ªéš¾äº‹ã€‚å½“ç„¶è¿™ä¸€ç‚¹ä¹Ÿéš¾ä¸å€’äº§å“ç»ç†ï¼Œä»–ä»¬æ€»ä¼šæƒ³å‡ºå„ç§å¥‡æ·«æ€ªæœ¯æ¥æŠ˜ç£¨æˆ‘ä»¬ï¼ˆç¨‹åºå‘˜ï¼‰ã€‚ä¸‹é¢ä»¥ç®€ä¹¦å’Œå¾®åšæ¥è§£è¯»ä¸‹ä¸»æµAPPæ˜¯å¦‚ä½•å¤„ç†çš„ã€‚

## ç®€ä¹¦&å¾®åš
![ç®€ä¹¦](https://upload-images.jianshu.io/upload_images/1085173-0da903effc6c05af.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/375)

![å¾®åš](https://upload-images.jianshu.io/upload_images/1085173-cb5c095f4ed0e065.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/375)

  æ­£å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç®€ä¹¦å’Œå¾®åšçš„å¸ƒå±€å¦‚å‡ºä¸€è¾™ã€‚ä¸€ä¸ªTableHeaderViewæ˜¾ç¤ºèƒŒæ™¯å›¾ã€å¤´åƒã€ç®€ä»‹ç­‰åŸºç¡€ä¿¡æ¯ã€‚ç„¶åæœ‰ä¸€ä¸ªSectionHeaderViewï¼Œæ‰¿è½½ä¸åŒçš„å†…å®¹åˆ†ç±»æŒ‡å¼•ï¼ˆåŠ¨æ€ã€æ–‡ç« ã€æ›´å¤šç­‰ï¼‰ï¼Œå¯ä»¥æ‚¬æµ®åœ¨é¡¶éƒ¨ã€‚ç„¶åå°±æ˜¯ä¸åŒåˆ†ç±»çš„æ•°æ®æµçš„TableViewï¼Œå¯ä»¥ç›´æ¥æ»šåŠ¨ã€‚**å»ºè®®å¤§å®¶æ‰“å¼€ç®€ä¹¦å’Œå¾®åšï¼ŒæŠŠç©ä¸€ä¸‹ã€‚**

  ç¬¬ä¸€çœ¼çœ‹ä¸Šå»ï¼Œæ„Ÿè§‰æ²¡æœ‰ä»€ä¹ˆéš¾åº¦å˜›ï¼Œå°±æ˜¯ä¸€ä¸ªä¸»TableViewåµŒå¥—ä¸€ä¸ªScrollViewï¼Œæ”¯æŒå·¦å³æ»šåŠ¨åˆ‡æ¢ï¼Œç„¶åScrollViewæ”¾ä¸‰ä¸ªTableViewã€‚ä½†æ˜¯ä»”ç»†æ€è€ƒä¼šæœ‰è®¸å¤šéš¾ç‚¹éœ€è¦è§£å†³ï¼Œæ¯”å¦‚ä¸»TableViewå’ŒåµŒå¥—TableViewçš„æ‰‹åŠ¿å†²çªï¼Œä¸‰ä¸ªå­TableViewçš„ä½ç½®æ›´æ–°ç­‰ã€‚

  å¦‚æœè¦è‡ªå·±è§£å†³è¿™äº›é—®é¢˜ï¼Œä¸”è¦è°ƒè¯•åˆ°ç›®æ ‡æ•ˆæœï¼Œå¯èƒ½è¦èŠ±ä¸Šä½ å¤§åŠå¤©æ—¶é—´äº†ã€‚è€Œä¸”æœ¬èº«ä¸ªäººèµ„æ–™é¡µé¢çš„ä¸šåŠ¡é€»è¾‘å°±ç‰¹åˆ«å¤šï¼Œå¦‚æœè¿˜è¦æ’å…¥è¿™ç§é¡µé¢äº¤äº’é€»è¾‘ï¼Œè¯´å®è¯ï¼Œå½“ä½ çœ‹åˆ°è®¸å¤šé›¶æ•£çš„ä»£ç äº¤ç»‡åœ¨ä¸€èµ·æ—¶ï¼Œä½ çš„å¤´ä¼šå’Œè¶³çƒä¸€æ ·å¤§ï¼ï¼ï¼
![è¶³çƒå¤´](https://upload-images.jianshu.io/upload_images/1085173-aee6817c3954c1d4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/375)

  æ‰€ä»¥è¿™ç¯‡æ–‡ç« ä¸ä¼šç€é‡è®²è§£å¦‚ä½•è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼ˆå¯ä»¥æŸ¥çœ‹æºç åˆ†æï¼‰ï¼Œè€Œæ˜¯å°†é¡µé¢ç»“æ„å°è£…å¥½ï¼Œä½ åªéœ€è¦èŠ±ä¸€åˆ†é’Ÿå¡«å……ä½ çš„ä¸šåŠ¡é€»è¾‘å³å¯ã€‚å¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘å»è°ƒè¯•é¡µé¢äº¤äº’é€»è¾‘äº†ğŸ‘

## æ ¸å¿ƒåŸç†
 è®©æ»‘åŠ¨æ‰‹åŠ¿ç»™æ¯ä¸ªScrollViewéƒ½å¯ä»¥å¤„ç†ï¼Œåªæ˜¯å¯¹äºmainTableViewå’ŒlistViewæœ‰ä¸åŒçš„é€»è¾‘
```
class JXUserProfileMainTableView: UITableView, UIGestureRecognizerDelegate {
    func gestureRecognizer(_ gestureRecognizer: UIGestureRecognizer, shouldRecognizeSimultaneouslyWith otherGestureRecognizer: UIGestureRecognizer) -> Bool {
        return gestureRecognizer.isKind(of: UIPanGestureRecognizer.classForCoder()) && otherGestureRecognizer.isKind(of: UIPanGestureRecognizer.classForCoder())
    }
}
```
- å¯¹äºmainTableViewçš„æ»šåŠ¨äº‹ä»¶å¤„ç†
```swift
func scrollViewDidScroll(_ scrollView: UIScrollView) {
        self.delegate.mainTableViewDidScroll?(scrollView)

        if (self.listItemScrollView != nil && self.listItemScrollView!.contentOffset.y > 0) {
            //mainTableViewçš„headerå·²ç»æ»šåŠ¨ä¸è§ï¼Œå¼€å§‹æ»šåŠ¨æŸä¸€ä¸ªlistViewï¼Œé‚£ä¹ˆå›ºå®šmainTableViewçš„contentOffsetï¼Œè®©å…¶ä¸åŠ¨
            self.mainTableView.contentOffset = CGPoint(x: 0, y: self.delegate.tableHeaderViewHeight(in: self))
        }

        if (scrollView.contentOffset.y < self.delegate.tableHeaderViewHeight(in: self)) {
            //mainTableViewå·²ç»æ˜¾ç¤ºäº†headerï¼ŒlistViewçš„contentOffsetéœ€è¦é‡ç½®
            for index in 0..<self.delegate.numberOfListViews(in: self) {
                let listView = self.delegate.userProfileView(self, listViewInRow: index)
                listView.scrollView.contentOffset = CGPoint.zero
            }
        }
    }
```
- å¯¹äºlistViewçš„æ»šåŠ¨äº‹ä»¶å¤„ç†
```swift
/// å¤–éƒ¨ä¼ å…¥çš„listViewï¼Œå½“å…¶å†…éƒ¨çš„scrollViewæ»šåŠ¨æ—¶ï¼Œéœ€è¦è°ƒç”¨è¯¥æ–¹æ³•
    open func listViewDidScroll(scrollView: UIScrollView) {
        self.listItemScrollView = scrollView

        if (self.mainTableView.contentOffset.y < self.delegate.tableHeaderViewHeight(in: self)) {
            //mainTableViewçš„headerè¿˜æ²¡æœ‰æ¶ˆå¤±ï¼Œè®©listScrollViewä¸€ç›´ä¸º0
            scrollView.contentOffset = CGPoint.zero;
            scrollView.showsVerticalScrollIndicator = false;
        } else {
            //mainTableViewçš„headeråˆšå¥½æ¶ˆå¤±ï¼Œå›ºå®šmainTableViewçš„ä½ç½®ï¼Œæ˜¾ç¤ºlistScrollViewçš„æ»šåŠ¨æ¡
            self.mainTableView.contentOffset = CGPoint(x: 0, y: self.delegate.tableHeaderViewHeight(in: self));
            scrollView.showsVerticalScrollIndicator = true;
        }
    }
```

## å®ç°æ•ˆæœ
![JXUserProfileViewGif.gif](https://upload-images.jianshu.io/upload_images/1085173-981d275f1b8a4bdb.gif?imageMogr2/auto-orient/strip)

## ä½¿ç”¨
1.å®ä¾‹åŒ–`JXUserProfileView`
```swift
        userProfileView = JXUserProfileView(delegate: self)
        userProfileView.delegate = self
        self.view.addSubview(userProfileView)
```
2.å®ç°`JXUserProfileViewDelegate`
```swift
@objc protocol JXUserProfileViewDelegate {

    ///mainTableViewçš„æ»šåŠ¨å›è°ƒï¼Œç”¨äºå®ç°å¤´å›¾è·Ÿéšç¼©æ”¾
    @objc optional func mainTableViewDidScroll(_ scrollView: UIScrollView)

    ///tableHeaderViewçš„é«˜åº¦
    func tableHeaderViewHeight(in userProfileView: JXUserProfileView) -> CGFloat

    ///è¿”å›tableHeaderView
    func tableHeaderView(in userProfileView: JXUserProfileView) -> UIView

    ///heightForHeaderOfSectionï¼Œå°±æ˜¯åˆ†ç±»è§†å›¾çš„é«˜åº¦
    func heightForHeaderOfSection(in userProfileView: JXUserProfileView) -> CGFloat

    ///viewForHeaderOfSectionï¼Œåˆ†ç±»è§†å›¾ï¼Œæˆ‘ç”¨çš„æ˜¯è‡ªå·±å°è£…çš„JXCategoryViewï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–çš„æˆ–è€…è‡ªå·±å†™
    func viewForHeaderOfSection(in userProfileView: JXUserProfileView) -> UIView

    ///åº•éƒ¨listViewçš„æ¡æ•°
    func numberOfListViews(in userProfileView: JXUserProfileView) -> Int

    ///è¿”å›å¯¹åº”indexçš„listViewï¼Œéœ€è¦æ˜¯UIViewçš„å­ç±»ï¼Œä¸”è¦éµå¾ªJXUserProfileListViewDelegateã€‚è¿™é‡Œè¦æ±‚è¿”å›ä¸€ä¸ªUIViewè€Œä¸æ˜¯ä¸€ä¸ªUIScrollViewï¼Œå› ä¸ºlistViewå¯èƒ½å¹¶ä¸åªæ˜¯ä¸€ä¸ªå•çº¯çš„TableViewï¼Œè¿˜ä¼šæœ‰å…¶ä»–çš„å…ƒç´ 
    func userProfileView(_ userProfileView: JXUserProfileView, listViewInRow row: Int) -> JXUserProfileListViewDelegate & UIView
}
```

3.è®©å¤–éƒ¨listViewéµä»`JXUserProfileListViewDelegate`åè®®
```swift
//è¯¥åè®®ä¸»è¦ç”¨äºmainTableViewå·²ç»æ˜¾ç¤ºäº†headerï¼ŒlistViewçš„contentOffsetéœ€è¦é‡ç½®æ—¶ï¼Œå†…éƒ¨éœ€è¦è®¿é—®åˆ°å¤–éƒ¨ä¼ å…¥è¿›æ¥çš„listViewå†…çš„scrollView
@objc protocol JXUserProfileListViewDelegate {
    var scrollView: UIScrollView { get }
}
```

4.å°†å¤–éƒ¨listViewçš„æ»šåŠ¨äº‹ä»¶ä¼ å…¥userProfileView
```
func listViewDidScroll(_ scrollView: UIScrollView) {
        userProfileView.listViewDidScroll(scrollView: scrollView)
    }
```

  ä¸ç”¨ä¸€åˆ†é’Ÿï¼Œå°±å¯ä»¥é›†æˆå®Œæ¯•ğŸ‘

## Github
[ä»“åº“åœ°å€](https://github.com/pujiaxin33/JXUserProfileView) å¦‚æœä½ å–œæ¬¢ï¼Œè®°å¾—ç‚¹é¢—â¤ï¸å“Ÿ

## æ¨èé˜…è¯»
[SGPagingView](https://github.com/kingsic/SGPagingView)



